2025-02-13 22:54:06,548 - INFO - Starting merge process for target_2024_Q4_bu in schema rvu
2025-02-13 22:54:07,287 - INFO - Columns fetched for target_2024_Q4_bu: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 22:54:07,287 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 22:54:07,287 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 22:54:07,287 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 22:54:08,039 - ERROR - Error during merge: (psycopg2.errors.UndefinedTable) relation "rvu.target_2024_q4_bu" does not exist

[SQL: ALTER TABLE rvu.target_2024_Q4_bu RENAME TO target_2024_Q4_bu_bu]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-13 23:05:07,370 - INFO - Starting merge process for target_2024_Q4_bu in schema rvu
2025-02-13 23:05:08,106 - INFO - Columns fetched for target_2024_Q4_bu: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:05:08,106 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:05:08,106 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:05:08,106 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:05:08,818 - ERROR - Error during merge: (psycopg2.errors.SyntaxError) syntax error at or near "."
LINE 1: ...ER TABLE "rvu"."target_2024_Q4_bu" RENAME TO "rvu"."target_2...
                                                             ^

[SQL: ALTER TABLE "rvu"."target_2024_Q4_bu" RENAME TO "rvu"."target_2024_Q4_bu_bu"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-13 23:07:15,587 - INFO - Starting merge process for target_2024_Q4_bu in schema rvu
2025-02-13 23:07:16,301 - INFO - Columns fetched for target_2024_Q4_bu: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:07:16,301 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:07:16,301 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:07:16,301 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:07:17,036 - ERROR - Error during merge: (psycopg2.errors.InsufficientPrivilege) must be owner of table target_2024_Q4_bu

[SQL: ALTER TABLE "rvu"."target_2024_Q4_bu" RENAME TO "target_2024_Q4_bu_bu"]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-13 23:12:43,518 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:12:44,278 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:12:44,280 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:12:44,280 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:12:44,280 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:12:45,016 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu
2025-02-13 23:12:45,767 - ERROR - Error during merge: (psycopg2.errors.UndefinedTable) relation "table_registry.quarter_detail" does not exist
LINE 1: SELECT * FROM table_registry.quarter_detail
                      ^

[SQL: SELECT * FROM table_registry.quarter_detail]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-13 23:21:37,595 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:21:38,332 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:21:38,332 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:21:38,332 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:21:38,332 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:21:39,068 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu
2025-02-13 23:21:39,795 - ERROR - Error during merge: (psycopg2.errors.UndefinedTable) relation "table_registry.quarter_detail" does not exist
LINE 1: SELECT * FROM table_registry.quarter_detail
                      ^

[SQL: SELECT * FROM table_registry.quarter_detail]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-13 23:32:43,829 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:32:44,582 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:32:44,582 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:32:44,591 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:32:44,591 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:32:45,332 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu
2025-02-13 23:32:46,077 - ERROR - Error during merge: "None of ['Update_type'] are in the columns"
2025-02-13 23:36:15,368 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:36:16,147 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:36:16,147 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:36:16,147 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:36:16,147 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:36:16,936 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu
2025-02-13 23:36:17,715 - ERROR - Error during merge: 'Status'
2025-02-13 23:38:19,144 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:38:19,928 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:38:19,928 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:38:19,928 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:38:19,928 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:38:20,703 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu
2025-02-13 23:38:21,481 - ERROR - Error during merge: 'EFFECTIVE_START_DATE'
2025-02-13 23:39:12,735 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:39:13,513 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:39:13,513 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:39:13,513 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:39:13,513 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:39:14,294 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu
2025-02-13 23:39:15,852 - ERROR - Error during merge: (psycopg2.errors.UndefinedTable) relation "rvu.target_2024_Q4_dv" does not exist
LINE 2:         INSERT INTO "rvu"."target_2024_Q4_dv" (STATUS_CODE, ...
                            ^

[SQL: 
        INSERT INTO "rvu"."target_2024_Q4_dv" (STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, status, effective_start_date, effective_end_date, version_id)
        SELECT STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, 
            1, 
            '01/01/2025', 
            '12/31/9999', 
            '2025_Q1'
        FROM "rvu"."source_2025_Q1" s
        LEFT JOIN "rvu"."target_2024_Q4_dv" t
        ON s.hcpcs_code = t.hcpcs_code AND s.modifier = t.modifier
        WHERE t.hcpcs_code IS NULL;
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-13 23:49:01,225 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-13 23:49:01,979 - INFO - Columns fetched for target_2024_Q4_dv: ['EFFECTIVE_START_DATE', 'EFFECTIVE_END_DATE', 'HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'STATUS', 'VERSION_ID']
2025-02-13 23:49:01,979 - INFO - Business Keys: ['hcpcs_code', 'modifier']
2025-02-13 23:49:01,979 - INFO - Excluded Fields: ['status', 'effective_start_date', 'effective_end_date', 'version_id', 'description']
2025-02-13 23:49:01,979 - INFO - Fields for Change Comparison: ['STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-13 23:49:03,091 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu and created a new table with the same structure and data
2025-02-13 23:49:04,609 - ERROR - Error during merge: (psycopg2.errors.UndefinedColumn) column "status_code" of relation "target_2024_Q4_dv" does not exist
LINE 2:         INSERT INTO "rvu"."target_2024_Q4_dv" (STATUS_CODE, ...
                                                       ^

[SQL: 
        INSERT INTO "rvu"."target_2024_Q4_dv" (STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, status, effective_start_date, effective_end_date, version_id)
        SELECT STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, 
            1, 
            '01/01/2025', 
            '12/31/9999', 
            '2025_Q1'
        FROM "rvu"."source_2025_Q1" s
        LEFT JOIN "rvu"."target_2024_Q4_dv" t
        ON s.hcpcs_code = t.hcpcs_code AND s.modifier = t.modifier
        WHERE t.hcpcs_code IS NULL;
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-14 00:04:13,346 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-14 00:04:14,074 - INFO - Columns fetched for source_2025_Q1: {'hcpcs_code': 'HCPCS_CODE', 'modifier': 'MODIFIER', 'description': 'description', 'status_code': 'STATUS_CODE', 'not_used_for_medicare_payment': 'NOT_USED_FOR_MEDICARE_PAYMENT', 'work_rvu': 'WORK_RVU', 'non_fac_pe_rvu': 'NON_FAC_PE_RVU', 'non_fac_na_indicator': 'NON_FAC_NA_INDICATOR', 'facility_pe_rvu': 'FACILITY_PE_RVU', 'facility_na_indicator': 'FACILITY_NA_INDICATOR', 'mp_rvu': 'MP_RVU', 'non_facility_total': 'NON_FACILITY_TOTAL', 'facility_total': 'FACILITY_TOTAL', 'pctc_ind': 'PCTC_IND', 'glob_days': 'GLOB_DAYS', 'pre_op': 'PRE_OP', 'intra_op': 'INTRA_OP', 'post_op': 'POST_OP', 'mult_proc': 'MULT_PROC', 'bilat_surg': 'BILAT_SURG', 'asst_surg': 'ASST_SURG', 'co_surg': 'CO_SURG', 'team_surg': 'TEAM_SURG', 'endo_base': 'ENDO_BASE', 'conv_factor': 'CONV_FACTOR', 'physician_supervision_of_diagnostic_procedures': 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'calculation_flag': 'CALCULATION_FLAG', 'diagnostic_imaging_family_indicator': 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'non_facility_pe_used_for_opps_payment_amount': 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'facility_pe_used_for_opps_payment_amount': 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'mp_used_for_opps_payment_amount': 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT'}
2025-02-14 00:04:14,821 - INFO - Columns fetched for target_2024_Q4_dv: {'effective_start_date': 'EFFECTIVE_START_DATE', 'effective_end_date': 'EFFECTIVE_END_DATE', 'hcpcs_code': 'HCPCS_CODE', 'modifier': 'MODIFIER', 'description': 'DESCRIPTION', 'status_code': 'STATUS_CODE', 'not_used_for_medicare_payment': 'NOT_USED_FOR_MEDICARE_PAYMENT', 'work_rvu': 'WORK_RVU', 'non_fac_pe_rvu': 'NON_FAC_PE_RVU', 'non_fac_na_indicator': 'NON_FAC_NA_INDICATOR', 'facility_pe_rvu': 'FACILITY_PE_RVU', 'facility_na_indicator': 'FACILITY_NA_INDICATOR', 'mp_rvu': 'MP_RVU', 'non_facility_total': 'NON_FACILITY_TOTAL', 'facility_total': 'FACILITY_TOTAL', 'pctc_ind': 'PCTC_IND', 'glob_days': 'GLOB_DAYS', 'pre_op': 'PRE_OP', 'intra_op': 'INTRA_OP', 'post_op': 'POST_OP', 'mult_proc': 'MULT_PROC', 'bilat_surg': 'BILAT_SURG', 'asst_surg': 'ASST_SURG', 'co_surg': 'CO_SURG', 'team_surg': 'TEAM_SURG', 'endo_base': 'ENDO_BASE', 'conv_factor': 'CONV_FACTOR', 'physician_supervision_of_diagnostic_procedures': 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'calculation_flag': 'CALCULATION_FLAG', 'diagnostic_imaging_family_indicator': 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'non_facility_pe_used_for_opps_payment_amount': 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'facility_pe_used_for_opps_payment_amount': 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'mp_used_for_opps_payment_amount': 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'status': 'STATUS', 'version_id': 'VERSION_ID'}
2025-02-14 00:04:14,821 - INFO - Mapped columns: ['HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-14 00:04:15,896 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu and created a new table with the same structure and data
2025-02-14 00:04:16,669 - INFO - Ensured target_2024_Q4_dv exists with the same structure as source_2025_Q1
2025-02-14 00:04:18,141 - ERROR - Error during merge: (psycopg2.errors.UndefinedColumn) column "hcpcs_code" of relation "target_2024_Q4_dv" does not exist
LINE 2:         INSERT INTO "rvu"."target_2024_Q4_dv" (HCPCS_CODE, M...
                                                       ^

[SQL: 
        INSERT INTO "rvu"."target_2024_Q4_dv" (HCPCS_CODE, MODIFIER, DESCRIPTION, STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, status, effective_start_date, effective_end_date, version_id)
        SELECT HCPCS_CODE, MODIFIER, description, STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, 
            1, 
            '01/01/2025', 
            '12/31/9999', 
            '2025_Q1'
        FROM "rvu"."source_2025_Q1" s
        LEFT JOIN "rvu"."target_2024_Q4_dv" t
        ON s.HCPCS_CODE = t.HCPCS_CODE AND s.MODIFIER = t.MODIFIER
        WHERE t.HCPCS_CODE IS NULL;
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-02-14 00:23:18,650 - INFO - Starting merge process for target_2024_Q4_dv in schema rvu
2025-02-14 00:23:19,433 - INFO - Columns fetched for source_2025_Q1: {'hcpcs_code': 'HCPCS_CODE', 'modifier': 'MODIFIER', 'description': 'description', 'status_code': 'STATUS_CODE', 'not_used_for_medicare_payment': 'NOT_USED_FOR_MEDICARE_PAYMENT', 'work_rvu': 'WORK_RVU', 'non_fac_pe_rvu': 'NON_FAC_PE_RVU', 'non_fac_na_indicator': 'NON_FAC_NA_INDICATOR', 'facility_pe_rvu': 'FACILITY_PE_RVU', 'facility_na_indicator': 'FACILITY_NA_INDICATOR', 'mp_rvu': 'MP_RVU', 'non_facility_total': 'NON_FACILITY_TOTAL', 'facility_total': 'FACILITY_TOTAL', 'pctc_ind': 'PCTC_IND', 'glob_days': 'GLOB_DAYS', 'pre_op': 'PRE_OP', 'intra_op': 'INTRA_OP', 'post_op': 'POST_OP', 'mult_proc': 'MULT_PROC', 'bilat_surg': 'BILAT_SURG', 'asst_surg': 'ASST_SURG', 'co_surg': 'CO_SURG', 'team_surg': 'TEAM_SURG', 'endo_base': 'ENDO_BASE', 'conv_factor': 'CONV_FACTOR', 'physician_supervision_of_diagnostic_procedures': 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'calculation_flag': 'CALCULATION_FLAG', 'diagnostic_imaging_family_indicator': 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'non_facility_pe_used_for_opps_payment_amount': 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'facility_pe_used_for_opps_payment_amount': 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'mp_used_for_opps_payment_amount': 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT'}
2025-02-14 00:23:20,219 - INFO - Columns fetched for target_2024_Q4_dv: {'effective_start_date': 'EFFECTIVE_START_DATE', 'effective_end_date': 'EFFECTIVE_END_DATE', 'hcpcs_code': 'HCPCS_CODE', 'modifier': 'MODIFIER', 'description': 'DESCRIPTION', 'status_code': 'STATUS_CODE', 'not_used_for_medicare_payment': 'NOT_USED_FOR_MEDICARE_PAYMENT', 'work_rvu': 'WORK_RVU', 'non_fac_pe_rvu': 'NON_FAC_PE_RVU', 'non_fac_na_indicator': 'NON_FAC_NA_INDICATOR', 'facility_pe_rvu': 'FACILITY_PE_RVU', 'facility_na_indicator': 'FACILITY_NA_INDICATOR', 'mp_rvu': 'MP_RVU', 'non_facility_total': 'NON_FACILITY_TOTAL', 'facility_total': 'FACILITY_TOTAL', 'pctc_ind': 'PCTC_IND', 'glob_days': 'GLOB_DAYS', 'pre_op': 'PRE_OP', 'intra_op': 'INTRA_OP', 'post_op': 'POST_OP', 'mult_proc': 'MULT_PROC', 'bilat_surg': 'BILAT_SURG', 'asst_surg': 'ASST_SURG', 'co_surg': 'CO_SURG', 'team_surg': 'TEAM_SURG', 'endo_base': 'ENDO_BASE', 'conv_factor': 'CONV_FACTOR', 'physician_supervision_of_diagnostic_procedures': 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'calculation_flag': 'CALCULATION_FLAG', 'diagnostic_imaging_family_indicator': 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'non_facility_pe_used_for_opps_payment_amount': 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'facility_pe_used_for_opps_payment_amount': 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'mp_used_for_opps_payment_amount': 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT', 'status': 'STATUS', 'version_id': 'VERSION_ID'}
2025-02-14 00:23:20,219 - INFO - Mapped columns: ['HCPCS_CODE', 'MODIFIER', 'DESCRIPTION', 'STATUS_CODE', 'NOT_USED_FOR_MEDICARE_PAYMENT', 'WORK_RVU', 'NON_FAC_PE_RVU', 'NON_FAC_NA_INDICATOR', 'FACILITY_PE_RVU', 'FACILITY_NA_INDICATOR', 'MP_RVU', 'NON_FACILITY_TOTAL', 'FACILITY_TOTAL', 'PCTC_IND', 'GLOB_DAYS', 'PRE_OP', 'INTRA_OP', 'POST_OP', 'MULT_PROC', 'BILAT_SURG', 'ASST_SURG', 'CO_SURG', 'TEAM_SURG', 'ENDO_BASE', 'CONV_FACTOR', 'PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES', 'CALCULATION_FLAG', 'DIAGNOSTIC_IMAGING_FAMILY_INDICATOR', 'NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT', 'MP_USED_FOR_OPPS_PAYMENT_AMOUNT']
2025-02-14 00:23:21,403 - INFO - Archived target_2024_Q4_dv as target_2024_Q4_dv_bu and created a new table with the same structure and data
2025-02-14 00:23:22,205 - INFO - Ensured target_2024_Q4_dv exists with the same structure as source_2025_Q1
2025-02-14 00:23:23,751 - ERROR - Error during merge: (psycopg2.errors.UndefinedColumn) column "hcpcs_code" of relation "target_2024_Q4_dv" does not exist
LINE 2:         INSERT INTO "rvu"."target_2024_Q4_dv" (HCPCS_CODE, M...
                                                       ^

[SQL: 
        INSERT INTO "rvu"."target_2024_Q4_dv" (HCPCS_CODE, MODIFIER, DESCRIPTION, STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, status, effective_start_date, effective_end_date, version_id)
        SELECT HCPCS_CODE, MODIFIER, description, STATUS_CODE, NOT_USED_FOR_MEDICARE_PAYMENT, WORK_RVU, NON_FAC_PE_RVU, NON_FAC_NA_INDICATOR, FACILITY_PE_RVU, FACILITY_NA_INDICATOR, MP_RVU, NON_FACILITY_TOTAL, FACILITY_TOTAL, PCTC_IND, GLOB_DAYS, PRE_OP, INTRA_OP, POST_OP, MULT_PROC, BILAT_SURG, ASST_SURG, CO_SURG, TEAM_SURG, ENDO_BASE, CONV_FACTOR, PHYSICIAN_SUPERVISION_OF_DIAGNOSTIC_PROCEDURES, CALCULATION_FLAG, DIAGNOSTIC_IMAGING_FAMILY_INDICATOR, NON_FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, FACILITY_PE_USED_FOR_OPPS_PAYMENT_AMOUNT, MP_USED_FOR_OPPS_PAYMENT_AMOUNT, 
            1, 
            '01/01/2025', 
            '12/31/9999', 
            '2025_Q1'
        FROM "rvu"."source_2025_Q1" s
        LEFT JOIN "rvu"."target_2024_Q4_dv" t
        ON s.HCPCS_CODE = t.HCPCS_CODE AND s.MODIFIER = t.MODIFIER
        WHERE t.HCPCS_CODE IS NULL;
        ]
(Background on this error at: https://sqlalche.me/e/20/f405)
